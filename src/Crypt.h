#define DBGPUZZLE
#define PRECISION 500 // MIRACLs precision

// Include MIRACL

#include "miracl\big.h"
extern Miracl precision;

#pragma comment(lib, "miracl.lib") // Don't forget to link against it


// std::chrono timer class, thx stackoverflow

#ifdef DBGPUZZLE

#include <chrono>

class Timer
{
public:
	Timer() : beg_(clock_::now()) {}
	void reset() { beg_ = clock_::now(); }
	double elapsed() const {
		return std::chrono::duration_cast<second_>
			(clock_::now() - beg_).count();
	}

private:
	typedef std::chrono::high_resolution_clock clock_;
	typedef std::chrono::duration<double, std::ratio<1> > second_;
	std::chrono::time_point<clock_> beg_;
};

#endif


// TimeLock object

struct time_lock
{
	time_lock(int t, char *n, char *a, char *ck)
		: t(t), n(n), a(a), ck(ck), key(0) {}

	int t;
	Big n, a, ck, key;
};


// Functions

std::string BigToString(Big a);
unsigned long __stdcall SolveTimeLock(void *lpParam);


// Puzzles below 

#define LOCK1_N \
	"103831947334275999048583132285768701667391291718741218732060488240700219442883418312570260632663098736040082669192113356513739156021066734307142468061946025828487427317142951945188053993540330034088766262860266570197771083191534152004141860736068626174544451007246236536711122059061428932971881705098393124111"

#define LOCK1_A \
	"93874390983687360711408752395219072100763236797064821758189628267265945027187941365666459177350541539634653316178950264577190767440500786098134307529920708426277676479541468561635769238964286335255615211546025623663937079061973670242016249037309968202000890408992582236777215445338083019802514079336840664178"

#define LOCK1_Ck \
	"21730352349279444951860111543675639274044102156023103526895590590077943163642319626758730168157199709728375444532583519168374330434796413883316596344364916010906196892626260550042256198791637440644233933392790419417940772342531295216937007348969181644009005619903034077772532758243938216482779407003097133661"

#define LOCK1_T 100000
	

#define LOCK2_N \
	"108633787581809821672148149464644567330728247867010494390974585222570153043382800990956670339109354565803244623772982962873913926774436673961982725858009679894348845926137133639280295034700200208292887972227856343027559128815199586497940409311454895196783821514340295511125389183126935642196214411566014828731"

#define LOCK2_A \
	"63158216602738983624174201433049663754753595391455076634126982463584561921845253197945302506502672427918351420430979197652093157850023750312374356688072396881205469988839844772634190380060276143875251790331711801434197880688678810497036475634654286817617475722936421128655761202258748249567724358719968573269"

#define LOCK2_Ck \
	"63830106839973705479795361512272332604764301621019218962754975072023127568161326524964395977226109420726799018018195102636235836585108237618300668545753995318828988232497835915627287232314186973990658909986753925932768412498939172534859029135975953132641370395603788104317314642829808157117023583144439895876"

#define LOCK2_T 1000000